<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<style>
    /* Print and Page Setup */
    @page { size: A4; margin: 0; }
    @media print { body { -webkit-print-color-adjust: exact; } }
    
    body { 
        margin: 0; 
        padding: 40px;
        font-family: 'Helvetica', 'Arial', sans-serif; 
        color: #333; 
        background: #fff;
        font-size: 12px;
        line-height: 1.4;
    }

    /* Header Section */
    .header { 
        display: flex; 
        justify-content: space-between; 
        align-items: flex-start;
        margin-bottom: 30px;
    }
    .brand h1 { 
        margin: 0; 
        font-size: 24px; 
        color: #1a3a5f; 
        text-transform: uppercase;
    }
    .brand p { margin: 2px 0; color: #666; }

    .doc-type { 
        text-align: right; 
        font-size: 42px; 
        color: #1a3a5f; 
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    /* Information Grid */
    .meta-grid {
        display: grid;
        grid-template-columns: 1.5fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
    }

    .info-box { border: 1px solid #e0e0e0; border-radius: 4px; overflow: hidden; }
    .box-header { 
        background: #1a3a5f; 
        color: #fff; 
        padding: 6px 12px; 
        font-weight: bold; 
        text-transform: uppercase;
        font-size: 10px;
    }
    .box-content { padding: 12px; min-height: 80px; }

    .meta-details { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .meta-item { border-bottom: 1px solid #f0f0f0; padding: 4px 0; }
    .meta-item span { display: block; font-size: 9px; color: #888; text-transform: uppercase; }
    .meta-item strong { display: block; font-size: 11px; color: #1a3a5f; }

    /* Table Styling */
    .table-section { margin-bottom: 30px; }
    table { width: 100%; border-collapse: collapse; }
    
    thead th { 
        background: #1a3a5f; 
        color: #fff; 
        text-align: left; 
        padding: 10px; 
        font-size: 10px; 
        text-transform: uppercase;
        border: 1px solid #1a3a5f;
    }

    tbody td { 
        padding: 10px; 
        border: 1px solid #e0e0e0; 
        vertical-align: top;
    }
    
    /* Summary Section */
    .footer-section { display: flex; justify-content: space-between; align-items: flex-start; }
    .footer-left { width: 55%; }
    .footer-right { width: 35%; }

    .summary-table { width: 100%; }
    .summary-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px dotted #ccc; }
    .summary-row.total { 
        background: #1a3a5f; 
        color: #fff; 
        padding: 10px; 
        border-radius: 4px; 
        font-size: 16px; 
        font-weight: bold;
        margin-top: 10px;
    }

    .bank-details { 
        background: #f8f9fa; 
        padding: 15px; 
        border-radius: 4px; 
        font-size: 10px;
        margin-top: 20px;
    }
    .bank-details strong { color: #1a3a5f; display: block; margin-bottom: 5px; border-bottom: 1px solid #ddd; }

    .notice { text-align: center; margin-top: 40px; color: #1a3a5f; font-weight: bold; font-style: italic; }
</style>
</head>
<body>

    <header class="header">
        <div class="brand">
            <h1>{{ company.name }}</h1>
            <p>{{ company.address }}</p>
        </div>
        <div class="doc-type">{{ invoice.title }}</div>
    </header>

    <div class="meta-grid">
        <div class="info-box">
            <div class="box-header">Bill To</div>
            <div class="box-content">
                <strong>{{ buyer.name }}</strong><br>
                {{ buyer.address }}<br><br>
                <strong>Notify:</strong> {{ notify.name }}<br>
                {{ notify.address }}
            </div>
        </div>
        <div class="meta-details">
            <div class="meta-item"><span>{{ invoice.title }} #</span><strong>{{ invoice.number }}</strong></div>
            <div class="meta-item"><span>Date</span><strong>{{ invoice.date }}</strong></div>
            <div class="meta-item"><span>Category</span><strong>{{ category }}</strong></div>
            <div class="meta-item"><span>Method</span><strong>{{ invoice.shipment_method }}</strong></div>
            <div class="meta-item"><span>Port Loading</span><strong>{{ invoice.port_loading }}</strong></div>
            <div class="meta-item"><span>Port Discharge</span><strong>{{ invoice.port_discharge }}</strong></div>
        </div>
    </div>

    <div class="table-section">
        <table>
            <thead>
                <tr>
                    <th style="width: 50%;">Description / Item No.</th>
                    <th style="width: 10%; text-align: center;">Qty</th>
                    <th style="width: 10%; text-align: center;">Unit</th>
                    <th style="width: 15%; text-align: right;">Rate</th>
                    <th style="width: 15%; text-align: right;">Amount</th>
                </tr>
            </thead>
            <tbody>
                {% for it in items %}
                <tr>
                    <td>
                        <strong>{{ it.item_no }}</strong><br>
                        <span style="color: #666;">{{ it.description }}</span>
                    </td>
                    <td style="text-align: center;">{{ it.qty }}</td>
                    <td style="text-align: center;">{{ it.unit }}</td>
                    <td style="text-align: right;">{{ it.rate }}</td>
                    <td style="text-align: right;">{{ it.amount }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="footer-section">
        <div class="footer-left">
            <div class="bank-details">
                <strong>Banking & Payment Details</strong>
                Bank: {{ bank.bank_name }} | Branch: {{ bank.branch }}<br>
                A/C Name: {{ bank.account_name }}<br>
                A/C No: <strong>{{ bank.account_no }}</strong><br>
                IFSC: {{ bank.ifsc }} | SWIFT: {{ bank.swift }}<br>
                IBAN: {{ bank.iban }} | Routing: {{ bank.routing }}
            </div>
            <p style="margin-top: 15px; font-size: 11px;">
                <strong>Amount in Words:</strong><br>
                <em>{{ totals.amount_in_words }}</em>
            </p>
        </div>

        <div class="footer-right">
            <div class="summary-table">
                <div class="summary-row"><span>Subtotal</span><span>{{ totals.subtotal }}</span></div>
                <div class="summary-row"><span>Freight</span><span>{{ totals.freight }}</span></div>
                <div class="summary-row"><span>Insurance</span><span>{{ totals.insurance }}</span></div>
                <div class="summary-row"><span>Other</span><span>{{ totals.other }}</span></div>
                <div class="summary-row total">
                    <span>Total</span>
                    <span>{{ totals.grand_total }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="notice">Thank you for your business!</div>

</body>
</html>