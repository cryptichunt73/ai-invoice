<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<style>
    @page { size: A4; margin: 0; }
    @media print { body { -webkit-print-color-adjust: exact; } }
    
    body { 
        margin: 0; 
        padding: 0;
        font-family: 'Trebuchet MS', 'Lucida Sans Unicode', sans-serif; 
        color: #333; 
        background: #fff;
    }

    /* Top Decorative Bar */
    .top-accent {
        height: 15px;
        background: linear-gradient(to right, #9b59b6 85%, #000 15%);
        width: 100%;
    }

    .main-container { padding: 40px 60px; }

    /* Header Section */
    .header-flex {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 50px;
    }

    .company-block h2 { margin: 0; font-size: 20px; color: #000; }
    .company-block p { margin: 2px 0; font-size: 13px; color: #666; }

    .invoice-title-block { text-align: right; }
    .invoice-title-block h1 { 
        margin: 0; 
        font-size: 72px; 
        text-transform: uppercase; 
        color: #000; 
        line-height: 1;
        font-weight: 900;
    }

    /* Billing Info Grid */
    .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        margin-bottom: 50px;
    }

    .bill-to-box h3 { 
        margin: 0 0 10px 0; 
        font-size: 14px; 
        text-transform: uppercase; 
        letter-spacing: 1px;
    }
    .bill-to-box p { margin: 2px 0; font-size: 14px; }

    .meta-data-box { text-align: right; font-size: 14px; }
    .meta-row { margin-bottom: 5px; }
    .meta-label { font-weight: bold; text-transform: uppercase; margin-right: 15px; width: 120px; display: inline-block; }

    /* Table Styling */
    .invoice-table { width: 100%; border-collapse: collapse; margin-bottom: 40px; }
    
    .invoice-table thead th {
        background-color: #e8daef; /* Soft purple background */
        color: #000;
        text-align: left;
        padding: 12px;
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .invoice-table tbody td {
        padding: 15px 12px;
        font-size: 14px;
        border-bottom: 1px solid #f2f2f2;
    }

    /* Summary Section */
    .summary-flex {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
    }

    .summary-item {
        width: 280px;
        display: flex;
        justify-content: space-between;
        padding: 8px 10px;
        font-size: 14px;
    }

    .total-highlight {
        background-color: #e8daef;
        font-weight: bold;
        font-size: 18px;
        margin-top: 10px;
        border-left: 5px solid #9b59b6; /* Deep purple accent */
    }

    /* Footer & Terms */
    .terms-section { margin-top: 100px; font-size: 12px; }
    .terms-section strong { display: block; margin-bottom: 5px; text-transform: uppercase; }

    .bottom-accent {
        position: fixed;
        bottom: 0;
        height: 25px;
        background: linear-gradient(to left, #9b59b6 15%, #000 85%);
        width: 100%;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        padding-right: 20px;
        color: #fff;
        font-size: 10px;
        font-style: italic;
    }

</style>
</head>
<body>

    <div class="top-accent"></div>

    <div class="main-container">
        <header class="header-flex">
            <div class="company-block">
                <h2>{{ company.name }}</h2>
                <p>{{ company.address }}</p>
                <p>Phone: {{ company.phone if company.phone else '555-0199' }}</p>
                <p>Email: {{ company.email if company.email else 'billing@company.com' }}</p>
            </div>
            <div class="invoice-title-block">
                <h1>{{ invoice.title }}</h1>
            </div>
        </header>

        <section class="info-grid">
            <div class="bill-to-box">
                <h3>Bill To</h3>
                <p><strong>{{ buyer.name }}</strong></p>
                <p>{{ buyer.address }}</p>
                <p>{{ buyer.email if buyer.email else '' }}</p>
            </div>
            <div class="meta-data-box">
                <div class="meta-row"><span class="meta-label">{{ invoice.title }} No.</span> <span>{{ invoice.number }}</span></div>
                <div class="meta-row"><span class="meta-label">Date</span> <span>{{ invoice.date }}</span></div>
                <div class="meta-row"><span class="meta-label">Due Date</span> <span>{{ invoice.date }}</span></div>
            </div>
        </section>

        <table class="invoice-table">
            <thead>
                <tr>
                    <th style="width: 50%;">Description</th>
                    <th style="width: 10%;">Hours</th>
                    <th style="width: 20%;">Price</th>
                    <th style="width: 20%; text-align: right;">Amount</th>
                </tr>
            </thead>
            <tbody>
                {% for it in items %}
                <tr>
                    <td>{{ it.description }}</td>
                    <td>{{ it.qty }}</td>
                    <td>{{ it.rate }}</td>
                    <td style="text-align: right;">{{ it.amount }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="summary-flex">
            <div class="summary-item"><span>Subtotal</span> <span>{{ totals.subtotal }}</span></div>
            <div class="summary-item"><span>Tax Rate</span> <span>{{ totals.insurance }}%</span></div>
            <div class="summary-item"><span>Total Tax</span> <span>{{ totals.other }}</span></div>
            <div class="summary-item total-highlight">
                <span>Total</span>
                <span>{{ totals.grand_total }}</span>
            </div>
        </div>

        <div class="terms-section">
            <strong>Terms</strong>
            <p>Payment is due within 30 days of the invoice date. Please include the invoice number on your check or wire transfer.</p>
        </div>
    </div>

    <div class="bottom-accent">
        Thank you for your business!
    </div>

</body>
</html>